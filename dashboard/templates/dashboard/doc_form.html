{% extends "dashboard/base.html" %}
{% block content %}
  <h2>{{ action }} Document</h2>
  <form method="post" enctype="multipart/form-data">
    {% csrf_token %}
    {{ form.as_p }}
    <button class="btn btn-success" type="submit">{{ action }}</button>
  </form>
  <script src="https://cdn.quilljs.com/1.3.6/quill.js"></script>
<link href="https://cdn.quilljs.com/1.3.6/quill.snow.css" rel="stylesheet">

<script>
  const editor = new Quill('#quill-editor', { theme: 'snow' });

  // Sync Quill content to hidden field on submit
  const form = document.querySelector('form');
  form.onsubmit = function () {
    const hidden = document.createElement('input');
    hidden.setAttribute('type', 'hidden');
    hidden.setAttribute('name', 'content');
    hidden.value = editor.root.innerHTML;
    form.appendChild(hidden);
  };

  // üîÅ Enable/Disable Tags based on visibility selection
  const visibilitySelect = document.getElementById('visibility-select');
  const tagsField = document.getElementById('tags-field');

  function toggleTags() {
    if (visibilitySelect.value === 'tagged') {
      tagsField.removeAttribute('disabled');
    } else {
      tagsField.setAttribute('disabled', 'true');
    }
  }

  visibilitySelect.addEventListener('change', toggleTags);
  document.addEventListener('DOMContentLoaded', toggleTags);
</script>

{% endblock %}
